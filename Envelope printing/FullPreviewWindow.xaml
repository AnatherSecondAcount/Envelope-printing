<Window x:Class="Envelope_printing.FullPreviewWindow"
 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
 xmlns:local="clr-namespace:Envelope_printing"
 Title="Full Preview" Height="800" Width="1000"
 UseLayoutRounding="True" SnapsToDevicePixels="True">
 <Grid>
 <!-- Scrollable centered preview with gray background -->
 <ScrollViewer x:Name="PreviewArea" Background="#E5E5E5" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
 PreviewMouseWheel="PreviewArea_PreviewMouseWheel"
 PreviewMouseDown="PreviewArea_PreviewMouseDown"
 PreviewMouseMove="PreviewArea_PreviewMouseMove"
 PreviewMouseUp="PreviewArea_PreviewMouseUp">
 <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
 <Grid.LayoutTransform>
 <ScaleTransform ScaleX="{Binding ZoomFactor}" ScaleY="{Binding ZoomFactor}"/>
 </Grid.LayoutTransform>
 <local:PrintPreviewCanvas DataContext="{Binding}"/>
 </Grid>
 </ScrollViewer>

 <!-- Bottom centered overlay controls -->
 <Grid VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Margin="10">
 <Grid.ColumnDefinitions>
 <ColumnDefinition Width="*"/>
 <ColumnDefinition Width="Auto"/>
 <ColumnDefinition Width="*"/>
 </Grid.ColumnDefinitions>
 <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
 <Border Padding="6" Style="{StaticResource OverlayPanelBorder}" Margin="0,0,8,0">
 <StackPanel Orientation="Horizontal">
 <Button Content="-" Command="{Binding ZoomOutCommand}" MinWidth="44"/>
 <Button Content="{Binding ZoomPercentage, StringFormat={}{0}%}" Command="{Binding ResetZoomCommand}" MinWidth="64" Margin="8,0"/>
 <Button Content="+" Command="{Binding ZoomInCommand}" MinWidth="44"/>
 </StackPanel>
 </Border>
 <Border Padding="6" Style="{StaticResource OverlayPanelBorder}">
 <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
 <Button Content="?" Command="{Binding PrevPageCommand}" MinWidth="44"/>
 <TextBlock Text="{Binding CurrentPageDisplay}" Margin="8,0" VerticalAlignment="Center"/>
 <Button Content="?" Command="{Binding NextPageCommand}" MinWidth="44"/>
 </StackPanel>
 </Border>
 </StackPanel>
 </Grid>
 </Grid>
</Window>