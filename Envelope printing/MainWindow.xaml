<Window x:Class="Envelope_printing.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Envelope_printing"
        mc:Ignorable="d"
        Title="Envelope Printer" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.DataContext>
        <local:ShellViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- Конвертер для управления видимостью -->
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- Базовый стиль для кнопок и переключателей навигации -->
        <Style x:Key="NavButtonBaseStyle" TargetType="ButtonBase">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="0"/>
            <!-- Управляем отступами внутри Grid -->
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ButtonBase">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EAF2FA"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Конечные стили, которые наследуются от базового -->
        <Style x:Key="NavButtonStyle" TargetType="Button" BasedOn="{StaticResource NavButtonBaseStyle}"/>
        <Style x:Key="NavToggleButtonStyle" TargetType="ToggleButton" BasedOn="{StaticResource NavButtonBaseStyle}"/>

        <!-- Стиль для текста на кнопках, который будет скрываться -->
        <Style x:Key="NavButtonTextStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Visibility" Value="Visible"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.IsLeftPanelExpanded, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <!-- Задаем имя колонке, чтобы анимация могла ее найти -->
            <ColumnDefinition Width="{Binding LeftPanelWidth}"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ЛЕВАЯ НАВИГАЦИОННАЯ ПАНЕЛЬ -->
        <Border Grid.Column="0" Background="#F8F9FA" BorderBrush="#E1E4E8" BorderThickness="1" Margin="5" CornerRadius="8">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" Color="Gray" Opacity="0.15" BlurRadius="8"/>
            </Border.Effect>

            <Grid ClipToBounds="True">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- Верхняя группа -->
                    <RowDefinition Height="*"/>
                    <!-- Распорка -->
                    <RowDefinition Height="Auto"/>
                    <!-- Нижняя группа -->
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Margin="4">
                    <Button Style="{StaticResource NavButtonStyle}" Command="{Binding ShowHomeCommand}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE80F;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="На главную" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </Button>
                    <Button Style="{StaticResource NavButtonStyle}" Command="{Binding ShowPrintPreviewCommand}" FontWeight="Bold">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE7F4;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="Печать конвертов" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </Button>
                </StackPanel>

                <StackPanel Grid.Row="2" VerticalAlignment="Bottom" Margin="4">
                    <Button Style="{StaticResource NavButtonStyle}" Command="{Binding ShowRecipientEditorCommand}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE716;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="База получателей" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </Button>
                    <Button Style="{StaticResource NavButtonStyle}" Command="{Binding ShowTemplateDesignerCommand}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE70B;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="Дизайнер" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </Button>
                    <Button Style="{StaticResource NavButtonStyle}" Command="{Binding ShowSettingsCommand}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE713;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="Настройки" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </Button>
                    <Separator Margin="4"/>
                    <ToggleButton Style="{StaticResource NavToggleButtonStyle}" IsChecked="{Binding IsLeftPanelExpanded, Mode=TwoWay}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="42"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" FontFamily="Segoe MDL2 Assets" Text="&#xE700;" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
                            <TextBlock Grid.Column="1" Text="Свернуть" Style="{StaticResource NavButtonTextStyle}"/>
                        </Grid>
                    </ToggleButton>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ОБЛАСТЬ КОНТЕНТА -->
        <Border Grid.Column="1" Margin="0,5,5,5" CornerRadius="8" SnapsToDevicePixels="True" Background="Transparent">
            <Border Background="White" BorderBrush="#E1E4E8" BorderThickness="1" CornerRadius="8">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" Color="Gray" Opacity="0.15" BlurRadius="8"/>
                </Border.Effect>
                <ContentControl Content="{Binding CurrentView}" Margin="5"/>
            </Border>
        </Border>
    </Grid>
</Window>